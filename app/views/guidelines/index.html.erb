<div>
  <div class="filters">
    <%= turbo_frame_tag :dropdown_items do %>
      <% items = [
        "<a href=#{guidelines_path(sort_by: :high_impact)} data-turbo-stream class=#{"active" if params[:sorted_by] == "high_impact"}>Impact (high first)</a>",
        "<a href=#{guidelines_path(sort_by: :low_impact)} data-turbo-stream class=#{"active" if params[:sorted_by] == "low_impact"}>Impact (low first)</a>",
        "<a href=#{guidelines_path(sort_by: :high_effort)} data-turbo-stream class=#{"active" if params[:sorted_by] == "high_effort"}>Effort (high first)</a>",
        "<a href=#{guidelines_path(sort_by: :low_effort)} data-turbo-stream class=#{"active" if params[:sorted_by] == "low_effort"}>Effort (low first)</a>"
      ] %>
      <%= render "components/dropdown", text: "Sort", items: items %>
    <% end %>

    <div class="dropdown" data-controller="dropdown">
      <button
        class="dropdown__btn"
        aria-expanded=false
        data-action="click->dropdown#toggleOpen"
      >
        <%= "Impact" %>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          version="1.1"
          width="10"
          height="10"
          viewBox="0 0 256 256"
          xml:space="preserve"
        >
          <defs>
          </defs>
          <g
            style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;"
            transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)"
          >
            <path
              d="M 58.799 58.33 L 16.466 15.998 c -1.059 -1.059 -2.776 -1.059 -3.835 0 L 0.794 27.834 c -1.059 1.059 -1.059 2.776 0 3.835 l 42.333 42.333 c 1.059 1.059 2.776 1.059 3.835 0 l 11.837 -11.837 C 59.858 61.107 59.858 59.39 58.799 58.33 z"
              style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill-rule: nonzero; opacity: 1;"
              transform=" matrix(1 0 0 1 0 0) "
              stroke-linecap="round"
            />
            <path
              d="M 31.201 58.33 l 42.333 -42.333 c 1.059 -1.059 2.776 -1.059 3.835 0 l 11.837 11.837 c 1.059 1.059 1.059 2.776 0 3.835 L 46.873 74.002 c -1.059 1.059 -2.776 1.059 -3.835 0 L 31.201 62.166 C 30.142 61.107 30.142 59.39 31.201 58.33 z"
              style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill-rule: nonzero; opacity: 1;"
              transform=" matrix(1 0 0 1 0 0) "
              stroke-linecap="round"
            />
          </g>
        </svg>
      </button>
      <div class="dropdown__list-container" data-dropdown-target="list">
        <ul class="dropdown__list dropdown__list-checkboxes">
          <%= form_with url: guidelines_path, method: :get,
                data: {turbo_stream: ''} do |f| %>
            <fieldset>
              <%= link_to "All ðŸŒ¿",
              request.parameters.except(:impact),
              class: "filter-form__reset-link #{"active" unless params[:impact].present?}" %>
              <%= label_tag "impact_low", class: 'filter-form__input-container' do %>
                Low impact ðŸŒ¿
                <%= check_box_tag "impact[]",
                "low",
                params[:impact]&.include?("low"),
                multiple: true,
                onchange: "this.form.requestSubmit()",
                id: "impact_low",
                class: "filter-form__checkbox",
                data: {
                  turbo_stream: ""
                } %>
                <span class="filter-form__checkmark"></span>
              <% end %>
              <%= label_tag "impact_medium", class: 'filter-form__input-container' do %>
                Medium impact ðŸŒ¿
                <%= check_box_tag "impact[]",
                "medium",
                params[:impact]&.include?("medium"),
                multiple: true,
                onchange: "this.form.requestSubmit()",
                id: "impact_medium",
                class: "filter-form__checkbox",
                data: {
                  turbo_stream: ""
                } %>
                <span class="filter-form__checkmark"></span>
              <% end %>
              <%= label_tag "impact_high", class: 'filter-form__input-container' do %>
                High impact ðŸŒ¿
                <%= check_box_tag "impact[]",
                "high",
                params[:impact]&.include?("high"),
                multiple: true,
                onchange: "this.form.requestSubmit()",
                id: "impact_high",
                class: "filter-form__checkbox",
                data: {
                  turbo_stream: ""
                } %>
                <span class="filter-form__checkmark"></span>
              <% end %>
            </fieldset>
          <% end %>
        </ul>
      </div>
    </div>
  </div>
</div>

<%= turbo_frame_tag :guidelines  do %>
  <%= render "guidelines", guidelines: @guidelines %>
<% end %>
